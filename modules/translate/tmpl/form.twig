<div class="navbar">
	<button class="btn btn-default navbar-btn" id="chck-{{ uid }}"> {{ tr.get('show_incomplete_translations') }}</button>
</div>

<form action="javascript:void(0)" id ="{{ uid }}">
	<input type="hidden" value="{{ lng }}" name="edit_lang" />
	
	<table style="width:80%;" class="table table-striped table-hover" id="tbl-{{ uid }}">
		<thead>
			<tr>
				<th style="width:100px;">ID</th>
				<th style="width:250px;">Italian</th>
				<th>Translation</th>
				<th style="width:20px;">Status</th>
			</tr>
		</thead>
		<tbody>
		
	{% for k, v in it %}
	{% if k %}
		<tr{% if edit_lang[k] == false %} class="error"{% endif %}>
			<td>{{ k }}</td>
			<td>{{ v|nl2br }}</td>
			<td><br />
				<textarea style="width:90%; {% if edit_lang[k] == false %} border:1px solid #ff0000; {% endif %}" name="{{ k }}" >{{ edit_lang[k] }}</textarea>
			</td>
			<td><button type="submit" class="btn btn-default"><i class="glyphicon {% if edit_lang[k] == false %}glyphicon-hand-left{% else %}glyphicon-ok{% endif %}"></i></button></td>
		</tr>
	{% endif %}
	{% endfor %}
		</tbody>
	</table>
	<button type="submit" class="btn btn-success">{{ tr.get('save') }}</button>
</form>

<script>
	$('#{{ uid }}').submit(function(){
		core.getJSON('translate_ctrl', 'save', false, $(this).serialize(), function(data){
			core.message(data.text, data.status);
			if (data.status == 'success'){
				$('#{{ uid }}').parents('div.transl-content').html(core.loading).load('./?obj=translate_ctrl&method=showForm&param[]={{ lng }}');
			}
		});
	});
	
	$('#chck-{{ uid }}').on('click', function(){
		$(this).toggleClass('btn-danger');
		if ($(this).hasClass('btn-danger')){
			$('#tbl-{{ uid }} tbody tr.error').fadeIn();
			$('#tbl-{{ uid }} tbody tr:not(.error)').fadeOut();
			$(this).text("{{ tr.get('show_all_translations') }}")
		} else {
			$('#tbl-{{ uid }} tbody tr').fadeIn();
			$(this).text("{{ tr.get('show_incomplete_translations') }}")
		}
		
	});
</script>