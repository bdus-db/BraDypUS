function renderDotToD3(t,e){var r=dagre.dot.toObjects(t);renderDagreObjsToD3({nodes:r.nodes,edges:r.edges},e)}function renderDagreObjsToD3(t,e){var r=t.nodes,n=t.edges,a=d3.select(e);a.select("#arrowhead").empty()&&a.append("svg:defs").append("svg:marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX",8).attr("refY",5).attr("markerUnits","strokewidth").attr("markerWidth",8).attr("markerHeight",5).attr("orient","auto").attr("style","fill: #333").append("svg:path").attr("d","M 0 0 L 10 5 L 0 10 z"),a.selectAll("g").remove();var d=a.append("g"),i=d.selectAll("g .node").data(r),l=i.enter().append("g").attr("class",(function(t){return t.nodeclass?"node "+t.nodeclass:"node"})).attr("id",(function(t){return"node-"+t.id})).each((function(t){t.nodePadding=10}));l.append("rect"),addLabels(l),i.exit().remove();var o=d.selectAll("g .edge").data(n),c=o.enter().append("g").attr("class","edge").attr("id",(function(t){return"edge-"+t.id})).each((function(t){t.nodePadding=0}));c.append("path").attr("marker-end","url(#arrowhead)"),addLabels(c),o.exit().remove();var s=d.selectAll("g.label"),h=s.selectAll(".htmllabel").attr("width","100000");h.select("div").html((function(t){return t.label})).each((function(t){t.width=this.clientWidth,t.height=this.clientHeight,t.nodePadding=0})),h.attr("width",(function(t){return t.width})).attr("height",(function(t){return t.height})),s.filter((function(t){return t.label&&"<"!==t.label[0]})).select("text").attr("text-anchor","left").append("tspan").attr("dy","1em").text((function(t){return t.label})),s.each((function(t){var e=this.getBBox();t.bbox=e,t.width=e.width+2*t.nodePadding,t.height=e.height+2*t.nodePadding})),d.attr("transform","translate(5, 5)"),a.call(d3.behavior.zoom().on("zoom",(function(){d.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}))),dagre.layout().nodes(r).edges(n).run(),o.each((function(t){var e=t.dagre.points;if(!e.length){var r=t.source.dagre,n=t.target.dagre;e.push({x:(r.x+n.x)/2,y:(r.y+n.y)/2})}})),i.attr("transform",(function(t){return"translate("+t.dagre.x+","+t.dagre.y+")"})).selectAll("g.node rect").attr("rx",5).attr("ry",5).attr("x",(function(t){return-(t.bbox.width/2+t.nodePadding)})).attr("y",(function(t){return-(t.bbox.height/2+t.nodePadding)})).attr("width",(function(t){return t.width})).attr("height",(function(t){return t.height})),o.selectAll("path").attr("d",(function(t){var e=t.dagre.points.slice(0);e.unshift(dagre.util.intersectRect(t.source.dagre,e[0]));var r=e[e.length-2],n=dagre.util.intersectRect(t.target.dagre,e[e.length-1]),a=r.x-n.x,d=r.y-n.y,i=2/Math.sqrt(Math.pow(a,2)+Math.pow(d,2));return e.push({x:n.x+i*a,y:n.y+i*d}),d3.svg.line().x((function(t){return t.x})).y((function(t){return t.y})).interpolate("linear").tension(.8)(e)})),d.selectAll("g.label rect").attr("x",(function(t){return-t.nodePadding})).attr("y",(function(t){return-t.nodePadding})).attr("width",(function(t){return t.width})).attr("height",(function(t){return t.height})),i.selectAll("g.label").attr("transform",(function(t){return"translate("+-t.bbox.width/2+","+-t.bbox.height/2+")"}))}function addLabels(t){var e=t.append("g").attr("class","label");e.append("rect"),e.filter((function(t){return t.label&&"<"===t.label[0]})).append("foreignObject").attr("class","htmllabel").append("xhtml:div").style("float","left"),e.filter((function(t){return t.label&&"<"!==t.label[0]})).append("text")}